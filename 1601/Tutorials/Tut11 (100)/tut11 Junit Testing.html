<!DOCTYPE html>
<html>
<head>
<title>COMP1601</title>
<link href="template.css" rel="stylesheet" type="text/css" />
<style>
body {
	font-family: arial;
	margin-left: 80px;
}
p {
	font-size:24px;
}
pre {font-size:20px;}
hr {
	width: 100%;
	height: 2px;
	
	margin-top:10px;
	margin-bottom:10px
}
.header {
	text-align: center;
	font-weight: bold;
	font-size: 40px;
	
	margin-top:0px;
	margin-bottom:0px;
	
	color: rgb(153, 0, 0);
}
.subheader {
	color: #000099;
	
	margin-bottom:100px;
}
.segment-header {
	color: rgb(0, 0, 153);
	font-size: 30px;
}
.black-bold {
	color: rgb(0,0,0);
	font-weight: bold;
}
.glossary-term {
	font-weight: 700;
	color: #000099;
}
.code {
	font-family: 'Courier New';
}
.comment {
	color:rgb(0, 128, 0);
}
ul li {
	margin-bottom: 5px;
	font-size:24px;
}.red {
	color: #F00;
}
</style>
</head>
<body>
<p class="header">COMP 1601 Winter 2020</p>
<p class="header subheader">Tut11 -JUnit Testing</p>
<p>&copy; L.D. Nel 2020</p>
<hr/>
<p class="red">Revisions:</p>
<hr/>
<p class="segment-header">Description</p>
<p>In this tutorial we will build a java utility class to serve our next application and introduce JUnit testing which is a popular java framework for running test cases on your code.</p>
<p>We are starting a new project to build a Tip 'N' Tax calculator. In this tutorial we will build a utility class to do the calculations for us and test that class.</p>
<p>Reading:</p>
<p><a href="http://www.tutorialspoint.com/junit/junit_overview.htm">http://www.tutorialspoint.com/junit/junit_overview.htm</a></p>
<p>and also</p>
<p><a href="http://junit.org/junit4/">http://junit.org/junit4/</a></p>
<div></div>
<p>Note in this tutorial we will be using JUnit version 4.2 because that is what Android Studio currently uses. There is however a newer JUnit version 5 out but don't use that.</p>
<p>&nbsp;</p>
<p>Part II of the tutorial is to make this part of the app work.</p>
<p>&nbsp;</p>
<p class="red">You need to demonstrate your exercise to the TA or Prof. before you leave the class to get credit for it. If you complete, or make significant progress on the exercise you will get a mark of 2. If you make some progress you will get a mark of 1 and can &quot;upgrade&quot; that mark to a 2 by showing your completed work within one week of this exercise. 0 marks for a no-show or unsufficient progress.</p>
<hr/>
<p class="segment-header">Demo Code</p>
<p>For this tutorial use your answer code from the previous tutorial as a starting point. It should look something like this when you run it:</p>
<p><img src="images/demo1.png" width="219" height="401" alt=""/></p>
<p>&nbsp;</p>
<hr>
<p class="segment-header">&nbsp;</p>
<p class="segment-header">Problem 1: Tip 'N' Tax Caculator</p>
<p>In this problem we want to build a java class that will be used to do our tip and tax calculations. In the <span class="black-bold">Android</span> project view locate the package that contains your main activity java class. Right click on the package and choose <span class="black-bold">New-&gt;Java Class</span>.</p>
<p><img src="images/problem1-1.png" width="887" height="259" alt=""/></p>
<p>&nbsp;</p>
<p>Call your class TipNTaxCalculator:</p>
<p><img src="images/problem1-2.png" width="529" height="412" alt=""/></p>
<p>&nbsp;</p>
<p>It is convention in java that class names start with a capital letter. Stick with that. Make sure <span class="black-bold">visibility:</span> is set to <span class="black-bold">Public</span>. Click OK. You should now have a new java class along with the class that represents your main activity:</p>
<p><img src="images/problem1-3.png" width="1048" height="234" alt=""/></p>
<p>&nbsp;</p>
<p><span class="code">TipNTaxCalculator</span> objects will be used to do the math calculations. Start by defining <span class="code">static</span> constants that will represent the default tax rate and default tip percentage and a constant that will be used to represent an invalid result (we will assume a result can never be negative.)</p>
<p><img src="images/problem1-4.png" width="874" height="268" alt=""/></p>
<p>&nbsp; </p>
<p>Add member variables that would represent the actual tax rate and actual tip percentage. We will allow <span class="code">TipNTaxCalculator</span> objects to have individual rates.</p>
<p>Also add a default constructor that will initialize the member variables using the values of the static constants and also add a constructor that will accept a tax rate and a tip percentage. Finally, add an instance method that would take a <span class="code">double</span> amount as a parameter and calculate and return the total based on the actual tax rate and tip rate:</p>
<p><img src="images/problem1-5.png" width="754" height="567" alt=""/></p>
<p>&nbsp;</p>
<p>We now have a rudimentary calculator that we should be able to start testing.</p>
<p>&nbsp;</p>
<hr>
<p class="segment-header">&nbsp;</p>
<p class="segment-header">Problem 2: Running the Default <span class="code">ExampleUnitTest</span></p>
<p>Android Studio, and android development in general, use Java's JUnit test framework. This framework provides a way to write test cases to run against your code. There are two kinds: tests that work on isolated java components, and test that involve android components as well. We will just be testing isolated java components (our tip and tax calculator) here.</p>
<p>When you build an android project using one of Android Studio's wizards it will add the scafolding for JUnit tests for you. In particular, it will build a directory that mirror's your app src directory but will include test classes instead. It provides the <span class="code">ExampleUnitTest</span> default test class. It also adds the dependency to your gradle build file to include  JUnit testing (The view below is when you are in the <span class="black-bold">Project</span> perspective):</p>
<p><img src="images/problem2-1.png" alt=""/></p>
<p>&nbsp;</p>
<p>You could add these items manually but you should not need to. Here would be the steps:</p>
<p>1) Inside your module/src directory create a new folder along side src/main called src/test.</p>
<p>2) Inside this test directory recreate the folder structure of your main directory.</p>
<p>3) Place your test classes in this test directory structure.</p>
<p>4) Add then testImplementation 'junit:junit:4.12' to your module's build.gradle file. </p>
<p>But again, you should not need to do this -it should already have been done for you.</p>
<p>&nbsp;</p>
<p>Open the <span class="code">ExampeUnitTest</span> source file and look at it's contents:</p>
<p><img src="images/problem2-2.png" width="840" height="305" alt=""/></p>
<p>The following things stand out:</p>
<p>1)The <span class="code">@Test</span> annotation</p>
<p>2)The <span class="code">assertEquals()</span> function invocation.</p>
<p>The <span class="code">@Test</span> is an annotation (smart comment) that identifies the <span class="code">addition_isCorrect()</span> method as a test case. The <span class="code">assertEquals(int a,int b)</span> is one of JUnits assertions. If a == b then the assert succeeds but if a != b then the assertion fails. When test cases are run we can see the results including, in particular, which tests cases failed.</p>
<p>To run the test cases in <span class="code">ExampleUnitTest</span> right click on the <span class="code">ExampleUnitTest</span> class in the project explorer and choose <span class="black-bold">Run 'ExampleUnitTest'</span></p>
<p><img src="images/problem2-3.png" width="672" height="538" alt=""/></p>
<p>&nbsp;</p>
<p>You should see the test results:</p>
<p><img src="images/problem2-4.png" width="989" height="238" alt=""/></p>
<p>&nbsp;</p>
<p>Now add another test case that would fail. Note you must put a <span class="code">@Test</span> annotation before each test method:</p>
<p><img src="images/problem2-5.png" width="648" height="209" alt=""/></p>
<p>&nbsp;</p>
<p>Re-run the test and notice how one test case fails:</p>
<p><img src="images/problem2-6.png" width="1126" height="267" alt=""/></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<hr>
<p>&nbsp;</p>
<p class="segment-header">Problem 3: Our Own TipNTaxCalculatorUnitTest Class</p>
<p>Right click on the module package in the test directory to create a new test class for testing our calculator. </p>
<p><img src="images/problem3-1.png" width="882" height="208" alt=""/></p>
<p>&nbsp;</p>
<p>Create a new class <span class="code">TipNTaxCalculatorUnitTest</span> and write a test method that will assert that if a negative amount is used the result will be <span class="code">TipNTaxCalculator.InvalidResult</span> (Make sure to copy the <span class="code">import</span> statements from the <span class="code">ExampleUnitTest</span> class:</p>
<p><img src="images/problem3-2.png" width="738" height="406" alt=""/></p>
<p>&nbsp;</p>
<p>This time you will likely see a complaint (<span class="code">assertEquals</span> method is striked out.) Android studio is not happy about us testing the equality of doubles. Why is that? What is wrong with comparing two double numbers?</p>
<p>In computer programming you should <span class="black-bold">NEVER</span> test for equality of real numbers. Examine some of the other options for <span class="code">assertEquals()</span> here: <a href="https://junit.org/junit4/javadoc/latest/index.html">https://junit.org/junit4/javadoc/latest/index.html</a> and choose the <span class="code">Assert</span> class documentation: </p>
<p>&nbsp;</p>
<p><img src="images/problem3-3.png" alt=""/></p>
<p>&nbsp;</p>
<p>Notice <span class="code">assertEquals(double, double)</span> was actually implemented at one time (it really should never have been implemented!). It has been <span class="black-bold">deprecated</span> and rightly so. There is however an <span class="code">assertEquals(double, double, double)</span> that tests whether two double's are within a certain tolerence, or delta, of each other. This is a reasonable thing to do with reals. Use this <span class="code">assertEquals()</span> method instead to program the test case:</p>
<p><img src="images/problem3-4.png" width="833" height="285" alt=""/></p>
<p>&nbsp;</p>
<p>Run this test case: </p>
<p><img src="images/problem3-5.png" width="1102" height="224" alt=""/></p>
<p>&nbsp;</p>
<p>Obviously it fails because we have not yet implemented the code to handle this situtation. It does illustrate a very important programming stragegy that is often employed: that of writing test cases before the code to be tested. Remember this. It will happen often in programming projects.</p>
<p>Implement the actual code in <span class="code">TipNTaxCalculator</span> that should handle this case:</p>
<p><img src="images/problem3-6.png" width="792" height="157" alt=""/></p>
<p>and re-run the test case:</p>
<p><img src="images/problem3-7.png" width="965" height="147" alt=""/></p>
<p>&nbsp;</p>
<p>This time it succeeds. Next we will write the necessary test cases to thoroughly test the calculator.</p>
<p>&nbsp;</p>
<hr>
<p>&nbsp;</p>
<p class="segment-header">Problem 4: Complete Testing of <span class="code">TipNTaxCalculator</span></p>
<p>Based on the above write all the required test methods (test cases) to thoroughly test the calculator. Your tests should cover at least all the following cases and any others you think are necessary. Also, of course, implement the code in <span class="code">TipNTaxCalculator</span> to handle those situations. (Check the various versions of <span class="code">assert</span> that might be helpful using the junit.org documenation.)</p>
<p>Your test cases should handle at least the following scenarios:</p>
<ul>
  <li>Amount used for calculation is negative</li>
  <li>Amount used for calculation is too large (pick a reasonable value for a restaurant bill).</li>
  <li>The tax percentage is less than zero</li>
  <li>The tax percentage is greater than 100%</li>
  <li>The tip percentage is less than zero</li>
  <li>The tip percentage is greater than 100%</li>
  <li>The calculation of just the tax is correct</li>
  <li>The calculation of just the tip is correct</li>
  <li>The calculation of the tax and tip is correct. Note here you should decided what the correct calculation should be. That is, does one tip on the amount or the amount including tax?</li>
</ul>
<p>You should add appropriate <span class="code">get</span> methods to the <span class="code">TipNTaxCalculator</span> class if your test code needs, for example, to get the current tax rate.</p>
<p>Add any important test cases you can think of to the above list and then demostrate your code passes all of them.</p>
<p>&nbsp;</p>
<hr>
<p class="segment-header">Part II</p>
<p class="segment-header">Problem 5: Wiring the App Together<span class="code"></span></p>
<p>Now that our calculator class is working and tested lets wire the app components to make this work. When we created the app's layout visually with the contraint layout tool we did not assign meaningful id's to the UI components. Change that by assigning more meanful names. For example:</p>
<p><img src="images/problem5-1.png" width="763" height="440" alt=""/></p>
<p>&nbsp;</p>
<p>Using what your learned from building the 1601Quiz App &quot;wire&quot; the app together so the amount text field and calculate button works. It can be helpful to open the older 1601Quiz app project in another Android Studio window to remind you of all the parts.</p>
<p>You will have to do some research on basic java classes String and also what you can do with an android EditText.</p>
<p>Here is the strategy you will need to implement, and don't forget about Logcat to help you with your debugging.</p>
<p>Assume the user has typed a number into the amount text field. When the calculate button is pressed the following needs to happen:</p>
<ul>
  <li>The string in the amount text field have to be obtained and then turned into a <span class="code">double</span></li>
  <li>the <span class="code">double</span> amount should be passed as an argument to an instance of <span class="code">TipNTaxCalculator</span> using it's <span class="code">calculate()</span> method.</li>
  <li>The resulting <span class="code">double</span> from the <span class="code">calculate()</span> method needs to be turned back into a <span class="code">String</span></li>
  <li>The result string needs to be put in the amount text field for the user to see.</li>
</ul>
<p>&nbsp;</p>
<p>Probably the most basic implementation would result in the following:</p>
<p><img src="images/problem5-2.png" width="227" height="371" alt=""/>&nbsp;&nbsp;&nbsp;
	<img src="images/problem5-3.png" width="244" height="366" alt=""/>&nbsp;&nbsp;&nbsp;
	<img src="images/problem5-4.png" width="206" height="367" alt=""/></p>
<p>&nbsp;</p>
<p>Improve on that by having the result shown to only two decimal places.</p>
<p>&nbsp;</p>
<p><span class="red">When you have completed these problems demonstrate your code to  the TA or Prof. to get credit for the tutorial.</span> </p>
<p>&nbsp;</p>

</body>
</html>
